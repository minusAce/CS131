Non-spark-on-k8s command provided, proceeding in pass-through mode...
+------+------+-----+----------+----------+---------+---------+--------------------+--------------------+----------+
|buying|safety|class|buying_idx|safety_idx|class_idx| features|       rawPrediction|         probability|prediction|
+------+------+-----+----------+----------+---------+---------+--------------------+--------------------+----------+
| vhigh|   low|unacc|       3.0|       1.0|      0.0|[3.0,1.0]| [576.0,0.0,0.0,0.0]|   [1.0,0.0,0.0,0.0]|       0.0|
| vhigh|   med|unacc|       3.0|       2.0|      0.0|[3.0,2.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|  high|unacc|       3.0|       0.0|      0.0|[3.0,0.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|   low|unacc|       3.0|       1.0|      0.0|[3.0,1.0]| [576.0,0.0,0.0,0.0]|   [1.0,0.0,0.0,0.0]|       0.0|
| vhigh|   med|unacc|       3.0|       2.0|      0.0|[3.0,2.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|  high|unacc|       3.0|       0.0|      0.0|[3.0,0.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|   low|unacc|       3.0|       1.0|      0.0|[3.0,1.0]| [576.0,0.0,0.0,0.0]|   [1.0,0.0,0.0,0.0]|       0.0|
| vhigh|   med|unacc|       3.0|       2.0|      0.0|[3.0,2.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|  high|unacc|       3.0|       0.0|      0.0|[3.0,0.0]|[396.0,180.0,0.0,...|[0.6875,0.3125,0....|       0.0|
| vhigh|   low|unacc|       3.0|       1.0|      0.0|[3.0,1.0]| [576.0,0.0,0.0,0.0]|   [1.0,0.0,0.0,0.0]|       0.0|
+------+------+-----+----------+----------+---------+---------+--------------------+--------------------+----------+
only showing top 10 rows

Accuracy (buying + safety): 0.7025462962962963
+-----+-------+--------+-----+
|doors|persons|lug_boot|class|
+-----+-------+--------+-----+
|    2|      2|   small|unacc|
|    2|      2|   small|unacc|
|    2|      2|   small|unacc|
|    2|      2|     med|unacc|
|    2|      2|     med|unacc|
|    2|      2|     med|unacc|
|    2|      2|     big|unacc|
|    2|      2|     big|unacc|
|    2|      2|     big|unacc|
|    2|      4|   small|unacc|
+-----+-------+--------+-----+
only showing top 10 rows

+-----+-------+--------+-----+---------+-----------+------------+---------+-------------+--------------------+--------------------+----------+
|doors|persons|lug_boot|class|doors_idx|persons_idx|lug_boot_idx|class_idx|     features|       rawPrediction|         probability|prediction|
+-----+-------+--------+-----+---------+-----------+------------+---------+-------------+--------------------+--------------------+----------+
|    2|      2|   small|unacc|      0.0|        0.0|         0.0|      0.0|    (3,[],[])|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|   small|unacc|      0.0|        0.0|         0.0|      0.0|    (3,[],[])|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|   small|unacc|      0.0|        0.0|         0.0|      0.0|    (3,[],[])|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     med|unacc|      0.0|        0.0|         2.0|      0.0|[0.0,0.0,2.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     med|unacc|      0.0|        0.0|         2.0|      0.0|[0.0,0.0,2.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     med|unacc|      0.0|        0.0|         2.0|      0.0|[0.0,0.0,2.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     big|unacc|      0.0|        0.0|         1.0|      0.0|[0.0,0.0,1.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     big|unacc|      0.0|        0.0|         1.0|      0.0|[0.0,0.0,1.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      2|     big|unacc|      0.0|        0.0|         1.0|      0.0|[0.0,0.0,1.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
|    2|      4|   small|unacc|      0.0|        1.0|         0.0|      0.0|[0.0,1.0,0.0]|[938.0,171.0,33.0...|[0.81423611111111...|       0.0|
+-----+-------+--------+-----+---------+-----------+------------+---------+-------------+--------------------+--------------------+----------+
only showing top 10 rows

Accuracy (doors + persons + lug_boot): 0.8142361111111112
